<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kh.replay.auth.admin.model.dao.AdminMapper">
	<select id="getMemberList" resultType="com.kh.replay.member.model.dto.MemberDTO">
    SELECT 
         MEMBER_ID AS memberId,
         REGEXP_REPLACE(EMAIL, '(.{3})(.*)(@.*)', '\1***\3') AS email,
         REGEXP_REPLACE(MEMBER_NAME, '(.)(.+)', '\1' || RPAD('*', LENGTH('\2'), '*')) AS name,
         GENDER AS gender,
         MBTI AS mbti,
         UPDATED_AT AS updatedAt,
      	 REGEXP_REPLACE(PHONE, '([0-9]{3})([0-9]{4})([0-9]{4})', '\1-****-\3') AS phone,
         GENRE AS genre,
         MEMBER_JOB AS job,
         NICKNAME AS nickName,
         CREATED_AT AS createdAt,
         ROLE AS role,
         STATUS AS status
    FROM TB_MEMBER
    WHERE MEMBER_ID IS NOT NULL
    AND STATUS = 'Y'
    ORDER BY CREATED_AT DESC
    OFFSET #{offset} ROWS
    FETCH NEXT #{size} ROWS ONLY
</select>

<select id="getMemberDetails" resultType="map">
	SELECT 
	       MEMBER_ID AS memberID,
	       EMAIL AS email,
	       MEMBER_NAME AS name,
	       PHONE AS phone,
	       GENDER AS gender,
	       MBTI AS mbti,
	       UPDATED_AT AS updateAt,
	       CREATED_AT AS createdAt,
	       GENRE AS genre,
	       MEMBER_JOB AS job,
	       NICKNAME AS nickName,
	       ROEL AS roel,
	       STATUS AS status
	       
	       FROM TB_MEMBER
	   		
	       
	       
	       
	
	
	
	
	
	
	
	
</select>
	

   

</mapper>