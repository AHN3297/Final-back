<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.kh.replay.global.like.model.dao.LikeMapper">

    <select id="checkLike" resultType="int" parameterType="map">
        SELECT 
               COUNT(1) 
          FROM 
               TB_UNIVERSE_LIKED 
         WHERE 
               UNIVERSE_ID = #{universeId} AND MEMBER_ID = #{memberId}
    </select>
    
    <insert id="insertLike" parameterType="map">
        INSERT 
          INTO 
               TB_UNIVERSE_LIKED (UNIVERSE_ID, MEMBER_ID) 
        VALUES 
               (#{universeId}, #{memberId})
    </insert>
    
    <delete id="deleteLike" parameterType="map">
        DELETE 
          FROM 
               TB_UNIVERSE_LIKED 
         WHERE 
               UNIVERSE_ID = #{universeId} AND MEMBER_ID = #{memberId}
    </delete>
    
    <select id="countLikes" resultType="int">
        SELECT 
               COUNT(1) 
          FROM 
               TB_UNIVERSE_LIKED 
         WHERE 
               UNIVERSE_ID = #{universeId}
    </select>
    
    <select id="findGenreIdByName"
    		resultType="long">
    	SELECT
    	       GENRE_ID
    	  FROM
    	       TB_GENRE
    	 WHERE
    	       GENRE_NAME = #{genreName}		
    </select>
    
    <select id="existsMemberGenre"
    		resultType="int">
    	SELECT
    	       COUNT(*)
    	  FROM
    	       TB_MEMBER_GENRE
    	 WHERE
    	       MEMBER_ID = #{memberId}
    	   AND
    	       GENRE_ID = #{genreId}
    </select>
    
    <insert id="insertMemberGenre"
    		parameterType="com.kh.replay.global.like.model.vo.LikeGenreVO">
    	<selectKey keyProperty="memberGenreNo" resultType="long" order="BEFORE">
			SELECT SEQ_MEMBER_GENRE_NO.NEXTVAL FROM DUAL  
		</selectKey>
    	INSERT
    	  INTO
    	       TB_MEMBER_GENRE
    	       (
    	       MEMBER_GENRE_NO
    	     , MEMBER_ID
    	     , GENRE_ID  
    	       )
    	VALUES
    		   (
    		   #{memberGenreNo}
    		 , #{memberId}
    		 , #{genreId}  
    		   )
    </insert>

</mapper>