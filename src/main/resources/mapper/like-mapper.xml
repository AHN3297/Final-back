<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.kh.replay.global.like.model.dao.LikeMapper">

    <select id="checkLike" resultType="int" parameterType="map">
        SELECT 
               COUNT(1) 
          FROM 
               TB_UNIVERSE_LIKED 
         WHERE 
               UNIVERSE_ID = #{universeId} AND MEMBER_ID = #{memberId}
    </select>
    
    <insert id="insertLike" parameterType="map">
        INSERT 
          INTO 
               TB_UNIVERSE_LIKED (UNIVERSE_ID, MEMBER_ID) 
        VALUES 
               (#{universeId}, #{memberId})
    </insert>
    
    <delete id="deleteLike" parameterType="map">
        DELETE 
          FROM 
               TB_UNIVERSE_LIKED 
         WHERE 
               UNIVERSE_ID = #{universeId} AND MEMBER_ID = #{memberId}
    </delete>
    
    <select id="countLikes" resultType="int">
        SELECT 
               COUNT(1) 
          FROM 
               TB_UNIVERSE_LIKED 
         WHERE 
               UNIVERSE_ID = #{universeId}
    </select>
    
    <select id="findSingerNoByApiId" resultType="Integer">
        SELECT 
               SINGER_NO 
          FROM 
               TB_API_SINGER 
         WHERE 
               API_SINGER_ID = #{apiSingerId}
    </select>

    <insert id="insertArtistApiInfo" useGeneratedKeys="true" keyProperty="singerNo" keyColumn="SINGER_NO">
        INSERT 
          INTO 
               TB_API_SINGER 
               (
               SINGER_NO
             , API_SINGER_NAME
             , SINGER_GENRE
             , SINGER_IMG_URL
             , API_SINGER_ID
               )
        VALUES (
               SEQ_SINGER_NO.NEXTVAL
             , #{apiSingerName}
             , #{singerGenre}
             , #{singerImgUrl}
             , #{apiSingerId}
               )
    </insert>

    <select id="checkArtistLikeExists" resultType="_int">
        SELECT 
               COUNT(*) 
          FROM 
               TB_FAV_SINGER 
         WHERE 
               MEMBER_ID = #{memberId} 
           AND 
               SINGER_NO = #{singerNo}
    </select>

    <insert id="insertFavoriteArtist">
        INSERT 
          INTO 
               TB_FAV_SINGER 
               (
               FAVORITE_SINGER_NO
             , MEMBER_ID
             , SINGER_NO
               )
        VALUES 
               (
               SEQ_FAVORITE_SINGER_NO.NEXTVAL
             , #{memberId}
             , #{singerNo}
               )
    </insert>

    <delete id="deleteArtistLike">
        DELETE 
          FROM 
               TB_FAV_SINGER
         WHERE 
               MEMBER_ID = #{memberId} 
           AND 
               SINGER_NO = #{singerNo}
    </delete>

</mapper>